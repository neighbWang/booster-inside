# APK 构建流程

以 *Android Gradle Plugin 3.0.0+* 为例，*Android APK* 的大致构建过程如下图所示：

![APK build process](data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U2NyaXB0VHlwZT0iYXBwbGljYXRpb24vZWNtYXNjcmlwdCIgY29udGVudFN0eWxlVHlwZT0idGV4dC9jc3MiIGhlaWdodD0iODE0cHgiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHN0eWxlPSJ3aWR0aDo3MjdweDtoZWlnaHQ6ODE0cHg7YmFja2dyb3VuZDojMDAwMDAwMDA7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA3MjcgODE0IiB3aWR0aD0iNzI3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tTUQ1PVtmYjM3NWQyZjllY2U3NmU4MDNmODQ3ZmIxOTI2ZDNlOV0KZW50aXR5IGdlbmVyYXRlU291cmNlcy0tPjxyZWN0IGZpbGw9IiNGRkJDQkMiIGhlaWdodD0iMzYuMjk2OSIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iMTQwIiB4PSIxMDYiIHk9IjIxOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEyMCIgeD0iMTE2IiB5PSIyNDAuOTk1MSI+Z2VuZXJhdGVTb3VyY2VzPC90ZXh0PjwhLS1NRDU9WzcxM2NhN2ZiNmFhMDRhNDE2NTc0NGFjYjUxZTMwNjVmXQplbnRpdHkgZ2VuZXJhdGVSZXNvdXJjZXMtLT48cmVjdCBmaWxsPSIjRkZCQ0JDIiBoZWlnaHQ9IjM2LjI5NjkiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE1NyIgeD0iMjg5LjUiIHk9IjgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMzciIHg9IjI5OS41IiB5PSIzMC45OTUxIj5nZW5lcmF0ZVJlc291cmNlczwvdGV4dD48IS0tTUQ1PVszM2EzMTJlYmNjNzBmOTdiZjNjNDUxNGZmZGU1MjY1NV0KZW50aXR5IGdlbmVyYXRlQXNzZXRzLS0+PHJlY3QgZmlsbD0iI0ZGQkNCQyIgaGVpZ2h0PSIzNi4yOTY5IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSIxMzQiIHg9IjU4MiIgeT0iNDQ0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTE0IiB4PSI1OTIiIHk9IjQ2Ni45OTUxIj5nZW5lcmF0ZUFzc2V0czwvdGV4dD48IS0tTUQ1PVszMTJlYmVhMzRjMjljZTJmY2IyMDM3MDIxNzBhMmRkZV0KZW50aXR5IG1lcmdlUmVzb3VyY2VzLS0+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgaGVpZ2h0PSIzNi4yOTY5IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSIxMzgiIHg9IjI5OSIgeT0iMTA1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZ0FuZEdseXBocyIgdGV4dExlbmd0aD0iMTE4IiB4PSIzMDkiIHk9IjEyNy45OTUxIj5tZXJnZVJlc291cmNlczwvdGV4dD48IS0tTUQ1PVtkNzU3YmQ4Njc2Y2QxYmEyZGRkMzgyZjYxYzdiMjkxOF0KZW50aXR5IG1lcmdlQXNzZXRzLS0+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgaGVpZ2h0PSIzNi4yOTY5IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSIxMTUiIHg9IjUxMi41IiB5PSI1NTciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI5NSIgeD0iNTIyLjUiIHk9IjU3OS45OTUxIj5tZXJnZUFzc2V0czwvdGV4dD48IS0tTUQ1PVsxMDdlNjFmOTk3NTExZWM3NzkwNzE2ZjE2NTY2YWQxYl0KZW50aXR5IHByb2Nlc3NSZXNvdXJjZXMtLT48cmVjdCBmaWxsPSIjRkVGRUNFIiBoZWlnaHQ9IjM2LjI5NjkiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjE0OSIgeD0iMjkzLjUiIHk9IjIxOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEyOSIgeD0iMzAzLjUiIHk9IjI0MC45OTUxIj5wcm9jZXNzUmVzb3VyY2VzPC90ZXh0PjwhLS1NRDU9WzRmNzYzNTFhMDI2NTE0NWViNjIxMGJkMThiOTBlYTM5XQplbnRpdHkgY29tcGlsZVNvdXJjZXMtLT48cmVjdCBmaWxsPSIjRkZCQ0JDIiBoZWlnaHQ9IjM2LjI5NjkiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMS41OyIgd2lkdGg9IjEzMCIgeD0iMTExIiB5PSIzMzEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIxMTAiIHg9IjEyMSIgeT0iMzUzLjk5NTEiPmNvbXBpbGVTb3VyY2VzPC90ZXh0PjwhLS1NRDU9W2EwZmM0MjE0MTIxOTIyZTY4YTg2MTVmMTIwYjgzY2NlXQplbnRpdHkgdHJhbnNmb3JtLS0+PHJlY3QgZmlsbD0iI0I3RUZDRCIgaGVpZ2h0PSIzNi4yOTY5IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSI4OSIgeD0iMTMxLjUiIHk9IjQ0NCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjY5IiB4PSIxNDEuNSIgeT0iNDY2Ljk5NTEiPnRyYW5zZm9ybTwvdGV4dD48IS0tTUQ1PVthOWIzM2Y2ZWNkYjczMTBhMjlkNjJhNjM5NDMxM2QyOV0KZW50aXR5IG1lcmdlRGV4LS0+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgaGVpZ2h0PSIzNi4yOTY5IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSI5MiIgeD0iMTMwIiB5PSI1NTciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI3MiIgeD0iMTQwIiB5PSI1NzkuOTk1MSI+bWVyZ2VEZXg8L3RleHQ+PCEtLU1ENT1bMThiNGMyMjBmMTdhZmEyZmExYjc5MDlmMTI1OWYyN2VdCmVudGl0eSBwYWNrYWdlLS0+PHJlY3QgZmlsbD0iI0ZFRkVDRSIgaGVpZ2h0PSIzNi4yOTY5IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDEuNTsiIHdpZHRoPSI3OSIgeD0iMjUyLjUiIHk9IjY3MCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjU5IiB4PSIyNjIuNSIgeT0iNjkyLjk5NTEiPnBhY2thZ2U8L3RleHQ+PCEtLU1ENT1bZTRlZGM0YzFlNzdkOGY2Y2E0ZTc4N2Y2ZmE2NGEwNmVdCmVudGl0eSBhc3NlbWJsZS0tPjxyZWN0IGZpbGw9IiNGRUZFQ0UiIGhlaWdodD0iMzYuMjk2OSIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAxLjU7IiB3aWR0aD0iODciIHg9IjMzLjUiIHk9Ijc2NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjY3IiB4PSI0My41IiB5PSI3ODkuOTk1MSI+YXNzZW1ibGU8L3RleHQ+PCEtLU1ENT1bODNhMGIyMzI5ZTQ4MmMwYmIyZjhlZDI2Y2U2YzZlZGFdCmxpbmsgZ2VuZXJhdGVTb3VyY2VzIHRvIGNvbXBpbGVTb3VyY2VzLS0+PHBhdGggZD0iTTE3NiwyNTQuMzQ0IEMxNzYsMjczLjU2OCAxNzYsMzA0LjYzIDE3NiwzMjUuNjYxICIgZmlsbD0ibm9uZSIgaWQ9ImdlbmVyYXRlU291cmNlcy0mZ3Q7Y29tcGlsZVNvdXJjZXMiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTc2LDMzMC43NzgsMTgwLDMyMS43NzgsMTc2LDMyNS43NzgsMTcyLDMyMS43NzgsMTc2LDMzMC43NzgiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjM3IiB4PSIxODUiIHk9IjI5Ny4wNjY5Ij4qLmphdmE8L3RleHQ+PCEtLU1ENT1bZjU3OTEwZmRiMTg4MDYxYTRjOTk3M2E5OTFjMzIwYmRdCmxpbmsgZ2VuZXJhdGVSZXNvdXJjZXMgdG8gbWVyZ2VSZXNvdXJjZXMtLT48cGF0aCBkPSJNMzY4LDQ0LjQyNCBDMzY4LDU5Ljk1OSAzNjgsODIuNzgzIDM2OCw5OS42NTUgIiBmaWxsPSJub25lIiBpZD0iZ2VuZXJhdGVSZXNvdXJjZXMtJmd0O21lcmdlUmVzb3VyY2VzIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM2OCwxMDQuNjg2LDM3Miw5NS42ODYsMzY4LDk5LjY4NiwzNjQsOTUuNjg2LDM2OCwxMDQuNjg2IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48IS0tTUQ1PVsxZjZjNDllMTFhN2Y5YmFhZGZhMzBhOTk4OGZhODcyNl0KbGluayBnZW5lcmF0ZUFzc2V0cyB0byBtZXJnZUFzc2V0cy0tPjxwYXRoIGQ9Ik02MzYuNjU2LDQ4MC4zNDQgQzYyMi44LDQ5OS44MTIgNjAwLjMwNCw1MzEuNDIxIDU4NS4zMzIsNTUyLjQ1OCAiIGZpbGw9Im5vbmUiIGlkPSJnZW5lcmF0ZUFzc2V0cy0mZ3Q7bWVyZ2VBc3NldHMiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iNTgyLjI1Nyw1NTYuNzc4LDU5MC43MzQ0LDU1MS43NjQ3LDU4NS4xNTYyLDU1Mi43MDQzLDU4NC4yMTY1LDU0Ny4xMjYsNTgyLjI1Nyw1NTYuNzc4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48IS0tTUQ1PVs2MWJkNzFlNTViYzczYTEyYTQ3NzdlOTgwMGIwYzk2NV0KbGluayBtZXJnZVJlc291cmNlcyB0byBwcm9jZXNzUmVzb3VyY2VzLS0+PHBhdGggZD0iTTM2OCwxNDEuMzQ0IEMzNjgsMTYwLjU2OCAzNjgsMTkxLjYzIDM2OCwyMTIuNjYxICIgZmlsbD0ibm9uZSIgaWQ9Im1lcmdlUmVzb3VyY2VzLSZndDtwcm9jZXNzUmVzb3VyY2VzIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjM2OCwyMTcuNzc4LDM3MiwyMDguNzc4LDM2OCwyMTIuNzc4LDM2NCwyMDguNzc4LDM2OCwyMTcuNzc4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSIzMiIgeD0iMzc3IiB5PSIxODQuMDY2OSI+cmVzLyo8L3RleHQ+PCEtLU1ENT1bNTcyNmI2OGJkNzU2OWU4ZTA3MGY4OTkxOGE4ZDEwZGNdCmxpbmsgcHJvY2Vzc1Jlc291cmNlcyB0byBjb21waWxlU291cmNlcy0tPjxwYXRoIGQ9Ik0zMzguNDIxLDI1NC4xIEMzMDMuNzUsMjc0LjE0NSAyNDYuNDA4LDMwNy4yOTUgMjA5Ljk1MiwzMjguMzcxICIgZmlsbD0ibm9uZSIgaWQ9InByb2Nlc3NSZXNvdXJjZXMtJmd0O2NvbXBpbGVTb3VyY2VzIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjIwNS42MTMsMzMwLjg4LDIxNS40MDcsMzI5Ljg0MTYsMjA5Ljk0MjUsMzI4LjM3ODksMjExLjQwNTIsMzIyLjkxNDQsMjA1LjYxMywzMzAuODgiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjM5IiB4PSIyOTMiIHk9IjI5Ny4wNjY5Ij5SLmphdmE8L3RleHQ+PCEtLU1ENT1bMDg2NTQ2ZjJmYThlMTE4M2UxMjhiMjQxOWRkNWNiMjhdCmxpbmsgY29tcGlsZVNvdXJjZXMgdG8gdHJhbnNmb3JtLS0+PHBhdGggZD0iTTE3NiwzNjcuMzQ0IEMxNzYsMzg2LjU2OCAxNzYsNDE3LjYzIDE3Niw0MzguNjYxICIgZmlsbD0ibm9uZSIgaWQ9ImNvbXBpbGVTb3VyY2VzLSZndDt0cmFuc2Zvcm0iIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTc2LDQ0My43NzgsMTgwLDQzNC43NzgsMTc2LDQzOC43NzgsMTcyLDQzNC43NzgsMTc2LDQ0My43NzgiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjQyIiB4PSIxODUiIHk9IjQxMC4wNjY5Ij4qLmNsYXNzPC90ZXh0PjwhLS1NRDU9W2IyODMzM2I0NzFkMTMzZjFmZDdiNTMxYmE2MTBmODRlXQpsaW5rIHRyYW5zZm9ybSB0byBtZXJnZURleC0tPjxwYXRoIGQ9Ik0xNzYsNDgwLjM0NCBDMTc2LDQ5OS41NjggMTc2LDUzMC42MyAxNzYsNTUxLjY2MSAiIGZpbGw9Im5vbmUiIGlkPSJ0cmFuc2Zvcm0tJmd0O21lcmdlRGV4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjE3Niw1NTYuNzc4LDE4MCw1NDcuNzc4LDE3Niw1NTEuNzc4LDE3Miw1NDcuNzc4LDE3Niw1NTYuNzc4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI0MiIgeD0iMTg1IiB5PSI1MjMuMDY2OSI+Ki5jbGFzczwvdGV4dD48IS0tTUQ1PVthZmJmZDk4NWY3YTc4ZGFmOWYzY2ViMTY4NDE1MDk3ZF0KbGluayB0cmFuc2Zvcm0gdG8gcGFja2FnZS0tPjxwYXRoIGQ9Ik0yMDQuODA4LDQ4MC4xODggQzIxNS45MDUsNDg4LjA1NyAyMjcuODU2LDQ5OC4yNTcgMjM2LDUxMCBDMjY5Ljk2Myw1NTguOTcyIDI4NC4wNzksNjI5LjU0MSAyODkuMyw2NjQuOTYgIiBmaWxsPSJub25lIiBpZD0idHJhbnNmb3JtLSZndDtwYWNrYWdlIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48cG9seWdvbiBmaWxsPSIjQTgwMDM2IiBwb2ludHM9IjI5MC4wMDcsNjY5LjkyNCwyOTIuNjk2Nyw2NjAuNDQ5NSwyODkuMzAxMyw2NjQuOTc0MSwyODQuNzc2OCw2NjEuNTc4NywyOTAuMDA3LDY2OS45MjQiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjI1IiB4PSIyODMiIHk9IjU3OS41NjY5Ij4qLnNvPC90ZXh0PjwhLS1NRDU9Wzc0MWJlODJjZWZkM2JhZGExODZiMGE0YWY5Y2VlYTVjXQpsaW5rIG1lcmdlQXNzZXRzIHRvIHBhY2thZ2UtLT48cGF0aCBkPSJNNTI3LjE3Miw1OTMuMSBDNDc1LjQyNiw2MTMuNzYyIDM4OC44MDMsNjQ4LjM0OSAzMzYuMzc0LDY2OS4yODIgIiBmaWxsPSJub25lIiBpZD0ibWVyZ2VBc3NldHMtJmd0O3BhY2thZ2UiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMzMxLjcyMiw2NzEuMTQsMzQxLjU2MzYsNjcxLjUxNzcsMzM2LjM2NTYsNjY5LjI4NiwzMzguNTk3Miw2NjQuMDg4LDMzMS43MjIsNjcxLjE0IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nQW5kR2x5cGhzIiB0ZXh0TGVuZ3RoPSI1NCIgeD0iNDU3IiB5PSI2MzYuMDY2OSI+YXNzZXRzLyo8L3RleHQ+PCEtLU1ENT1bZGVmYmVhYjI3NzY3YTdhZjQzNTlhNzYyMTFhNDVkNzZdCmxpbmsgcHJvY2Vzc1Jlc291cmNlcyB0byBwYWNrYWdlLS0+PHBhdGggZD0iTTM3MS4wMjgsMjU0LjI0MiBDMzc0LjU4MywyNzYuMDE0IDM4MCwzMTQuNjYxIDM4MCwzNDggQzM4MCwzNDggMzgwLDM0OCAzODAsNTc2IEMzODAsNjE0LjI4MyAzNDcuNDYsNjQ3LjA1MiAzMjEuOTU0LDY2Ni44NTcgIiBmaWxsPSJub25lIiBpZD0icHJvY2Vzc1Jlc291cmNlcy0mZ3Q7cGFja2FnZSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIzMTcuOTI3LDY2OS45MjMsMzI3LjUxMDYsNjY3LjY1MjgsMzIxLjkwNDksNjY2Ljg5MzgsMzIyLjY2NCw2NjEuMjg4MSwzMTcuOTI3LDY2OS45MjMiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjE1NyIgeD0iMzg5IiB5PSI0NjYuNTY2OSI+cmVzb3VyY2VzLXt2YXJpYW50fS5hcF88L3RleHQ+PCEtLU1ENT1bY2M4ODRmODFmYmI3YWQ1NGRmYzMyMDg3NzMyNjI5YWNdCmxpbmsgbWVyZ2VEZXggdG8gcGFja2FnZS0tPjxwYXRoIGQ9Ik0xNjIuNTcsNTkzLjA0MSBDMTUzLjUzMiw2MDYuNzI2IDE0NC45NDIsNjI1LjkxNiAxNTUsNjQwIEMxNzUuODA3LDY2OS4xMzYgMjE1Ljg0OSw2ODAuNDAxIDI0Ny4yOTIsNjg0LjY2MSAiIGZpbGw9Im5vbmUiIGlkPSJtZXJnZURleC0mZ3Q7cGFja2FnZSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PHBvbHlnb24gZmlsbD0iI0E4MDAzNiIgcG9pbnRzPSIyNTIuMjYxLDY4NS4yODYsMjQzLjgzMjQsNjgwLjE5MSwyNDcuMzAwMyw2ODQuNjYwMiwyNDIuODMxMSw2ODguMTI4MSwyNTIuMjYxLDY4NS4yODYiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmdBbmRHbHlwaHMiIHRleHRMZW5ndGg9IjEwMSIgeD0iMTY0IiB5PSI2MzYuMDY2OSI+Y2xhc3Nlc3tOfS5kZXg8L3RleHQ+PCEtLU1ENT1bNGFjMjY1MDZlZDlhYTQ5YzJlNGM5YmY5M2M1ODhkYjFdCmxpbmsgY29tcGlsZVNvdXJjZXMgdG8gYXNzZW1ibGUtLT48cGF0aCBkPSJNMTEwLjc2LDM2NC43NDQgQzYyLjgxODgsMzc5Ljg4NCA2LDQwOC44MzMgNiw0NjEgQzYsNDYxIDYsNDYxIDYsNjg5IEM2LDcxOS4zMDY0IDI5LjQ3MDQsNzQ2LjE2NzQgNDkuNDIyNSw3NjMuNTI2NiAiIGZpbGw9Im5vbmUiIGlkPSJjb21waWxlU291cmNlcy0mZ3Q7YXNzZW1ibGUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iNTMuMzU4LDc2Ni44Njk5LDQ5LjA4ODgsNzU3Ljk5NDQsNDkuNTQ3NSw3NjMuNjMyNiw0My45MDkyLDc2NC4wOTEzLDUzLjM1OCw3NjYuODY5OSIgc3R5bGU9InN0cm9rZTogI0E4MDAzNjsgc3Ryb2tlLXdpZHRoOiAxLjA7Ii8+PCEtLU1ENT1bMWYxNWI1OGQ2YzMyMjFiMmY2ZTFhNmM3YzhiMDM1MDldCmxpbmsgdHJhbnNmb3JtIHRvIGFzc2VtYmxlLS0+PHBhdGggZD0iTTE2MC45MTUsNDgwLjAwOSBDMTQ1Ljk2Miw0OTcuODcyIDEyMy42NTMsNTI3LjQyNyAxMTIsNTU3IEM4My45NjEzLDYyOC4xNTUgNzguMjkwMyw3MjAuMTA3NyA3Ny4yMDkzLDc2MS43NTQ3ICIgZmlsbD0ibm9uZSIgaWQ9InRyYW5zZm9ybS0mZ3Q7YXNzZW1ibGUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyBzdHJva2UtZGFzaGFycmF5OiA3LjAsNy4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iNzcuMDk0NCw3NjYuODE2OCw4MS4yOTc1LDc1Ny45MDk5LDc3LjIwNzgsNzYxLjgxODEsNzMuMjk5Niw3NTcuNzI4NCw3Ny4wOTQ0LDc2Ni44MTY4IiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48IS0tTUQ1PVs3NTk1NzQyYmE1MDlmYTZiMjNhYjBiY2YxN2E2YTNhNF0KbGluayBwYWNrYWdlIHRvIGFzc2VtYmxlLS0+PHBhdGggZD0iTTI1My4wNjUsNzA2LjIwMzggQzIxNS42MjIsNzIyLjc0ODQgMTU5LjEzMiw3NDcuNzA5MSAxMjAuMjkyLDc2NC44NzEgIiBmaWxsPSJub25lIiBpZD0icGFja2FnZS0mZ3Q7YXNzZW1ibGUiIHN0eWxlPSJzdHJva2U6ICNBODAwMzY7IHN0cm9rZS13aWR0aDogMS4wOyIvPjxwb2x5Z29uIGZpbGw9IiNBODAwMzYiIHBvaW50cz0iMTE1LjY0NSw3NjYuOTI0MiwxMjUuNDkzOCw3NjYuOTQ0NCwxMjAuMjE4Miw3NjQuOTAyOSwxMjIuMjU5Nyw3NTkuNjI3MiwxMTUuNjQ1LDc2Ni45MjQyIiBzdHlsZT0ic3Ryb2tlOiAjQTgwMDM2OyBzdHJva2Utd2lkdGg6IDEuMDsiLz48IS0tTUQ1PVtkOGUzYmY1NDE3OGI4ODJjODZlYWRhMGMyYzdhYTBjMl0KQHN0YXJ0dW1sDQpza2lucGFyYW0gcmVjdGFuZ2xlPDxiZWhhdmlvcj4+IHsNCiAgICByb3VuZENvcm5lciAyNQ0KfQ0Kc2tpbnBhcmFtIGJhY2tncm91bmRjb2xvciB0cmFuc3BhcmVudA0Kc2tpbnBhcmFtIHNoYWRvd2luZyBmYWxzZQ0KDQpyZWN0YW5nbGUgZ2VuZXJhdGVTb3VyY2VzICAgICNmZmJjYmMNCnJlY3RhbmdsZSBnZW5lcmF0ZVJlc291cmNlcyAgI2ZmYmNiYw0KcmVjdGFuZ2xlIGdlbmVyYXRlQXNzZXRzICAgICAjZmZiY2JjDQpyZWN0YW5nbGUgbWVyZ2VSZXNvdXJjZXMNCnJlY3RhbmdsZSBtZXJnZUFzc2V0cw0KcmVjdGFuZ2xlIHByb2Nlc3NSZXNvdXJjZXMNCnJlY3RhbmdsZSBjb21waWxlU291cmNlcyAgICAgI2ZmYmNiYw0KcmVjdGFuZ2xlIHRyYW5zZm9ybSAgICAgICAgICAjYjdlZmNkDQpyZWN0YW5nbGUgbWVyZ2VEZXgNCnJlY3RhbmdsZSBwYWNrYWdlDQpyZWN0YW5nbGUgYXNzZW1ibGUNCg0KZ2VuZXJhdGVTb3VyY2VzICAgLWQtPiBjb21waWxlU291cmNlcyA6ICIgICouamF2YSINCmdlbmVyYXRlUmVzb3VyY2VzIC1kLT4gbWVyZ2VSZXNvdXJjZXMNCmdlbmVyYXRlQXNzZXRzICAgIC1kLT4gbWVyZ2VBc3NldHMNCm1lcmdlUmVzb3VyY2VzICAgIC1kLT4gcHJvY2Vzc1Jlc291cmNlcyA6ICIgIHJlcy8qIg0KcHJvY2Vzc1Jlc291cmNlcyAgLWQtPiBjb21waWxlU291cmNlcyA6ICIgIFIuamF2YSINCmNvbXBpbGVTb3VyY2VzICAgIC1kLT4gdHJhbnNmb3JtIDogIiAgKi5jbGFzcyINCnRyYW5zZm9ybSAgICAgICAgIC1kLT4gbWVyZ2VEZXggOiAiICAqLmNsYXNzIg0KdHJhbnNmb3JtICAgICAgICAgLWQtPiBwYWNrYWdlIDogIiAgKi5zbyINCm1lcmdlQXNzZXRzICAgICAgIC1kLT4gcGFja2FnZSA6ICIgIGFzc2V0cy8qIg0KcHJvY2Vzc1Jlc291cmNlcyAgLWQtPiBwYWNrYWdlIDogIiAgcmVzb3VyY2VzLXt2YXJpYW50fS5hcF8iDQptZXJnZURleCAgICAgICAgICAtZC0+IHBhY2thZ2UgOiAiICBjbGFzc2Vze059LmRleCINCmNvbXBpbGVTb3VyY2VzICAgIC1kLT4gYXNzZW1ibGUNCnRyYW5zZm9ybSAgICAgICAgIC4uLj4gYXNzZW1ibGUNCnBhY2thZ2UgICAgICAgICAgIC1kLT4gYXNzZW1ibGUNCkBlbmR1bWwNCgpQbGFudFVNTCB2ZXJzaW9uIDEuMjAyMC4wOWJldGExNShVbmtub3duIGNvbXBpbGUgdGltZSkKKEdQTCBzb3VyY2UgZGlzdHJpYnV0aW9uKQpKYXZhIFJ1bnRpbWU6IEphdmEoVE0pIFNFIFJ1bnRpbWUgRW52aXJvbm1lbnQKSlZNOiBKYXZhIEhvdFNwb3QoVE0pIDY0LUJpdCBTZXJ2ZXIgVk0KSmF2YSBWZXJzaW9uOiAxNC4wLjErNwpPcGVyYXRpbmcgU3lzdGVtOiBMaW51eApEZWZhdWx0IEVuY29kaW5nOiBVVEYtOApMYW5ndWFnZTogZW4KQ291bnRyeTogVVMKLS0+PC9nPjwvc3ZnPg==)

# Transform API

从 *Android Gradle Plugin 1.5.0-beta1* 开始，为了简化注入自定义 *class* 的操作，*Android* 提供了 *Transform API*，允许第三方插件在 *class* 文件被转换成 *dex* 之前进行修改，在此之前，如果要实现同样的操作，只能通过 *Hook Task* 的方式才能做到。*Transform API* 的用法也很简单：

```java
android.registerTransform(new MyTransform());
```

或者

```java
android.registerTransform(new MyTransform(), dependencies);
```

> `dependencies` 为 `MyTransform` 所属的 `TransformTask` 所依赖的 *Task*

# Transform Pipeline

*Transform Pipeline* 是 *Transform API* 在 *Android Gradle Plugin* 内部的实现方式，是由一系列 *TransformStream* 和 *Transform* 所组成。

## Transform Stream

每个 *Transform Stream* 都有特定的类型（Content Types）和作用域（Scopes）。

### Content Types

| 内容类型                                        | 描述                                                   |
|-------------------------------------------------|--------------------------------------------------------|
| `QualifiedContent.DefaultContentType.CLASSES`   | *class* 或者 *JAR* 文件                                |
| `QualifiedContent.DefaultContentType.RESOURCES` | Java 资源                                              |
| `ExtendedContentType.DEX`                       | *dex* 文件                                             |
| `ExtendedContentType.NATIVE_LIBS`               | *so* 动态库                                            |
| `ExtendedContentType.CLASSES_ENHANCED`          | *Instant Run* 更新的 *class*                           |
| `ExtendedContentType.DATA_BINDING`              | *data binding* 产物                                    |
| `ExtendedContentType.DEX_ARCHIVE`               | *dex* 存档文件，每个 *class* 对应一个单独的 *dex* 文件 |

### Scopes

| 作用域                                           | 描述                            |
|--------------------------------------------------|---------------------------------|
| `QualifiedContent.Scope.PROJECT`                 | 仅作用于当前工程                |
| `QualifiedContent.Scope.SUB_PROJECTS `           | 作用于所有子工程                |
| `QualifiedContent.Scope.EXTERNAL_LIBRARIES`      | 作用于外部依赖库                |
| `QualifiedContent.Scope.TESTED_CODE`             | 作用于当前 *variant* 的测试代码 |
| `QualifiedContent.Scope.PROVIDED_ONLY`           | 仅作用于 *provided* 的依赖      |
| `QualifiedContent.Scope.PROJECT_LOCAL_DEPS`      | 作用于工程的本地依赖包          |
| `QualifiedContent.Scope.SUB_PROJECTS_LOCAL_DEPS` | 作用于所有子工程的本地依赖包    |
| `InternalScope.MAIN_SPLIT`                       | 作用于 *Instant Run* 模式下主包 |
| `InternalScope.LOCAL_DEPS`                       | 作用于本地依赖库                |
| `InternalScope.FEATURES`                         | 作用于 *Dynamic Feature* 工程   |

*Transform Manager* 中定义了一些常用的 *Scopes*：

| 作用域                                                | 描述                                                 |
|-------------------------------------------------------|------------------------------------------------------|
| `TransformManager.SCOPE_FULL_PROJECT`                 | 作用于整个工程，包括当前工程、所有子工程及外部依赖库 |
| `TransformManager.SCOPE_FULL_WITH_FEATURES`           | 作用于整个工程以及 *Dynamic Feature* 工程            |
| `TransformManager.SCOPE_FULL_LIBRARY_WITH_LOCAL_JARS` | 作用于当前工程以及本地依赖库                         |


### Original Stream & Intermediate Stream

根据 *Transform Stream* 的起源，又将其分为原始流（Original Stream）和中间流（Intermediate Stream），顾名思义，原始流是由 *Android Gradle Plugin* 创建，并由其它的 *Transform* 进行消费，而自定义的 *Transform* 消费后产生的 *Transform Stream* 则为中间流（非原始的）。

当我们通过自定义 *Transform* 来处理构建中间产物，可以从两个维度来关注：

1. *Content Types*：即 *Transform* 要处理的内容是什么类型，可以是多种类型；
1. *Scope*：即 *Transform* 要处理哪里的内容，可以是多个作用域；

当通过 *Transform API* 注册了自定义的 *Transform* 后，*Transform Manager* 就会根据 *Transform* 关注的 *Content Types* 和 *Scopes* 从现有的 *Transform Stream* 列表中选择对类型和作用域的流作为该 *Transform* 的输入，而该 *Transform* 的输出（*Intermediate Stream*）则作为下一个 *Transform* 的输入，每个 *Transform* 通过 *Transform Stream* 连接起来，这样就形成了管道。

![Transform Pipeline](data:image/png;base64,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)

# 上帝视角

至此，我们已经了解了 *Transform Pipeline* 的内部实现细节，如何自定义一个 *Transform* 只对当前 *Transform Pipeline* 中的内容进行观察而不修改呢？
